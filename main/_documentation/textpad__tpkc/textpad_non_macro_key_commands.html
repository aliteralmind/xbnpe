<HTML><HEAD>
   <TITLE>TextPad Non-Macro Key-Commands (XBN-PhraseExpress)</TITLE>
	<meta name="viewport" content="width=device-width" />
</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF"><a name="top"></a>

<H1>XBN-PhraseExpress:</H1>
<H2>TextPad Built-In Commands</H2>

<P>This project is for defining and assinging key-commands to the built-in commands in
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences &gt; Keyboard</CODE>
</P>

<P><B>TextPad Built-In Commands</B> ('TPKC', where 'kc' is for 'key-command') project assigns key-commands to all of the built-in commands in the TextPad application (such as <CODE>FileOpen</CODE> and <CODE>EditCopy</CODE>). These commands (each being setup with specific key-commands) are critical to many other projects in XBN-PhraseExpress. This project does NOT assign key-commands to user-created (or example) macros or tools--that is, any commands that may be edited or deleted by the user.</P>

<P>All</P>

<P><I>I have personally decided to make TextPad the environment in which most of my PhraseExpress macros are executed.</I></P>

<P><B>CONTENTS</B><UL>
	<LI><CODE><A HREF="#defs"><CODE>[GO]</CODE></A></CODE> Basic definitions</LI>
	<LI><CODE><A HREF="#cfgvars"><CODE>[GO]</CODE></A></CODE> All configuration variables in a TPKC Command Instance</LI>
	<LI><CODE><A HREF="#bldglblcfg"><CODE>[GO]</CODE></A></CODE> Building the tpkc global command-configuration from scratch</LI>
	<LI><CODE><A HREF="#pexdirs"><CODE>[GO]</CODE></A></CODE> Directory structure in the PhraseExpress application</LI>
	<LI><CODE><A HREF="#zTpkcCreateAllGlblCmdCfgFilesForAllCats"><CODE>[GO]</CODE></A></CODE> Process: <CODE>zTpkcCreateAllGlblCmdCfgFilesForAllCats</CODE></LI>
	<LI><CODE><A HREF="#zConvertTextPadKCCatListingsToPEConfig"><CODE>[GO]</CODE></A></CODE> Process: <CODE>zConvertTextPadKCCatListingsToPEConfig</CODE></LI>
	<LI><CODE><A HREF="#zTranslateFullyFinnessedCatListingsToPeCfg_M_catl"><CODE>[GO]</CODE></A></CODE> Process: <CODE>zTranslateFullyFinnessedCatListingsToPeCfg_M_catl</CODE></LI>
</LI>
</UL></P>

<PRE>

<HR/>

</PRE>
<a name="pexdirs"/>

<H2>Directory structure in the PhraseExpress application</H2>

<P>Here is the directory structure needed in PhraseExpress</P>

<PRE STYLE="background-color:#E1E1E1;">XBN-PhraseExpress
   TextPad
      Built-In Commands (TPKC Project)
         Build
         Command configuration: Global
         Command configuration: User-specific
         Main TextPad command phrases [CALL THESE!!]
         TextPad: Built In Commands (TPKC)    <I>&lt;--This directory must be viewable to your users in a popup menu, and be associated to the &quot;hotkey&quot; zCASpDNR_SLASH</I>
            1 specific category
            1 specific command
            1 user-input cat/cmd
            All cmds in all cats
            View KC-pause flag</PRE>


<a name="bldglblcfgdirs"/>
<H3>Directories</H3>

<P>Taking the original TextPad category command-listings, and converting them to TPKC raw global configuration (after following the above steps). Output is stored in
<BR> &nbsp; &nbsp; <CODE>zXPROOT_DIR_tpkcRawCfgGlobal:</CODE>
<BR> &nbsp; &nbsp; <CODE>{#insert zXPROOT_DIR_tpkcRawCfgGlobal}</CODE>
<BR>Converting the raw global configuration to the TPKC global command configuration. Output is stored in
<BR> &nbsp; &nbsp; <CODE>zzXPSUB_DIR_tpkcCmdConfigGlobal</CODE>
<BR> &nbsp; &nbsp; <CODE>{#insert zzXPSUB_DIR_tpkcCmdConfigGlobal}[category-name]\</CODE>
<BR>such as
<BR> &nbsp; &nbsp; <CODE>{#insert zzXPSUB_DIR_tpkcCmdConfigGlobal}characters\</CODE></P>

<P>In other words, the INPUT directory for the
<BR> &nbsp; &nbsp; <CODE><A HREF="#zTpkcCreateAllGlblCmdCfgFilesForAllCats">zTpkcCreateAllGlblCmdCfgFilesForAllCats</A></CODE>
<BR>process is:
<BR> &nbsp; &nbsp; <CODE>zXPROOT_DIR_tpkcRawCfgGlobal</CODE>
<BR>and OUTPUT directory is:
<BR> &nbsp; &nbsp; <CODE>zzXPSUB_DIR_tpkcCmdConfigGlobal</CODE></P>


<PRE>

<HR/>

</PRE>
<a name="defs"/>
<H2>Basic definitions</H2>

<P><UL>
	<LI><CODE><A HREF="#bootstrapdef"><CODE>[GO]</CODE></A></CODE> Bootstrap commands</LI>
	<LI><B>Global command configuration</B>:
	<BR>Configuration regarding each built-in command, that is the same regardless the custom key-commands assigned (or unassigned) by each user.
	<BR><BR>In other words, this configuration is the same for ALL installations of both XBN-PhraseExpress and TextPad, on all computers for all users.</LI>
	<LI><B>User-specific command configuration</B>:
	<BR>Defines the specific key-commands as assigned, or not assigned, by a specific user, on a specific computer, with a specific TextPad installation. This specifically definess all (non-bootstrap) key-commands for all built-in commands.</LI>
</UL></P>



<a name="bootstrapdef"/>
<H2>Definition: Bootstrap commands</H2>

<P>There are <U>bootstrap</U> commands and <U>non-bootstrap</U> commands (the latter abbreviated '<B>nbs</B>'). A bootstrap command is a phrase that must exist in order for certain projects to function. There are bootstrap commands required by <I>all</I> XBN-PhraseExpress projects (called &quot;xbnpe bootstraps&quot;), and each project may have its own bootstrap commands as well. The single bootstrap command needed by the TPKC project itself, for example, is the command for opening the Preferences dialog box (as stored in
<BR> &nbsp; &nbsp; <CODE>XBN-PhraseExpress/TextPad/dialogs/preferences/tp_preferences_dialog_bootstrap_commands.px</CODE>).</P>

<P>All bootstrap commands must exist before the project(s) that depend on them can be executed in any fashion.</P>

<P>An example xbnpe-bootstrap is the built-in TextPad command
<BR> &nbsp; &nbsp; <CODE>EditCopy</CODE>
<BR> &nbsp; &nbsp; (<CODE>TextPad &gt; Configure &gt; Preferences... &gt; Keyboard &gt; Categories &gt; Edit &gt; EditCopy</CODE>)
<BR>This is referenced by the phrase
<BR> &nbsp; &nbsp; <CODE>zTECopy</CODE>
<BR>which is located in
<BR> &nbsp; &nbsp; <CODE>XBN-PhraseExpress/zGLOBAL/xbn_phraseexpress_bootstrap_kcs.px</CODE></P>

<P>The value of this phrase is the <I>key-command</I> necessary to trigger <CODE>EditCopy</CODE> in TextPad:
<BR> &nbsp; &nbsp; <CODE>\\\{#insert zTECopyEsc\\\}</CODE>
<BR><B>Notes:</B><UL>
	<LI>I use Dvorak layout, so the 'j' on my keyboard is in the same position as the 'c' on yours (in QWERTY).</LI>
	<LI>If any sleep is required, in order for PhraseExpress to not execute subsequent phrases too quickly, this pause must be included after the key-command is complete. <I>This pause should handle <B>most</B> cases. Extreme cases should have additional sleep manually inserted.</I></LI>
	<LI>The call to <B><CODE>zTSlp</CODE></B> does absolutely nothing--by default, <CODE>zTSlp</CODE> is an empty phrase. However, this call makes it possible to slow down execution of <I>all</I> XBN-PhraseExpress code, when analyzing problems. See
	<BR> &nbsp; &nbsp; <CODE>XBN-PhraseExpress/phrase_express/dev__dbg__key_press_speeds.px</CODE></LI>
	<LI>The <I>literal</I> key command for this xbnpe-bootstrap is stored in
	<BR> &nbsp; &nbsp; <CODE>zTECopyEsc</CODE>
	<BR>All bootstrap commands have a literal (<CODE>'...Esc'</CODE>) equivalent. This is for debugging purposes, especially for diagnosing key-command conflicts among multiple built-in TextPad commands. This is described further in a below section. All literal xbnpe-bootstraps are stored in
<BR> &nbsp; &nbsp; <CODE>XBN-PhraseExpress/zGLOBAL/xbn_phraseexpress_bootstrap_kcs_escaped.px</CODE></LI>
</UL>

<P>Each built-in TextPad command can have, at a maximum, one bootstrap key-command (kc). Each command can also have zero or more non-bootstrap (nbs) commands, as discussed elsewhere.</P>

<P><I>Unfortunately, these escaped key-command phrases are not programatically related in any way to their actual bootstrap phrase. Therefore, you must manually confirm that, for example, both
<BR> &nbsp; &nbsp; <CODE>zTECopyEsc</CODE>
<BR>and
<BR> &nbsp; &nbsp; <CODE>zTECopy</CODE>
<BR>contain the same key-command (with different escape-d-ness).</I></P>


<PRE>

<HR/>

</PRE>

<a name="cfgvars"/>
<H2>All configuration variables in a TPKC Command Instance</H2>

<P>A built-in TextPad command, as it is configured in the TextPad Non-Macro Key-Commands project ('TPKC'), is made up of seven phrases (each called a &quot;configuration variable&quot;). These seven variables, as a whole, are considered a <B>TPKC Command Instance</B>. These variables are is split into two sections:<UL>
	<LI><B>Global:</B> The same information for all users, regardless of how they configured their TextPad installation.</LI>
	<LI><B>User-Specific:</B> The specific key-commands as configured by each user.</LI>
</UL></P>

<P>Here is the configuration of an actual tpkc-command-instance (as of 4/27/2013):
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences... &gt; Keyboard &gt; File &gt; <B><U>FileClose</U></B></CODE></P>

<H3><U>Global configuration for <CODE>'FileClose'</CODE></U></H3>

<PRE STYLE="background-color:#E1E1E1;">-<B>zTpkcFileCloseAbrv1C [<A HREF="#zTpkcFileCloseAbrv1C">go</A>]</B>
Fcls
-<B>zTpkcFclsNameTC [<A HREF="#zTpkcFclsNameTC">go</A>]</B>
FileClose
-<B>zTpkcFclsGTStepsFromListTop [<A HREF="#zTpkcFclsGTStepsFromListTop">go</A>]</B>
(*NOTHING! No steps! This command is the top-most command in the list.*)
-<B>zTpkcFclsCatName [<A HREF="#zTpkcFclsCatName">go</A>]</B>
File
-<B>zTpkcFclsBootstrapPhrsNmIf [<A HREF="#zTpkcFclsBootstrapPhrsNmIf">go</A>]</B>
zTEFileClose</PRE>

<H3><U>User-specific configuration for <CODE>'FileClose'</CODE></U></H3>

<PRE STYLE="background-color:#E1E1E1;">-<B>zTpkcFileCloseNbsKcEsc1 [<A HREF="#zTpkcFileCloseNbsKcEsc1">go</A>]</B>
\\\{#CTRL \\\{#F12\\\}\\\}\\\{#sleep 10\\\}\\\{#CTRL \\\{#F9\\\}\\\}\\\{#sleep 100\\\}\\\{#insert zTSlp\\\}
-<B>zTpkcFileCloseNbsKcCount [<A HREF="#zTpkcFileCloseNbsKcCount">go</A>]</B>
1</PRE>

<H3>Details on each configuration variable</H3>

<P>Note that<UL>
	<LI><B><CODE><I>[full-command-name]</I></CODE></B> means the full name of the command, exactly as it exists in the TextPad preferences dialog, under the &quot;Keyboard&quot; branch:
	<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences... &gt; Keyboard</CODE></LI>
	<LI><B><CODE><I>[command-abbreviation]</I></CODE></B> means the command's abbreviation, as configured in <CODE>zTpkc<I>[full-command-name]</I>Abrv1C</CODE>.</LI>
</UL></P>

<a name="zTpkcFileCloseNbsKcEsc1"/>
<H4>User-specific TPKC-config-var: <U><CODE>zTpkc<I>[full-command-name]</I>NbsKcEsc<I>[number]</I></CODE></U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFileCloseNbsKcEsc1</CODE></LI>
</UL></P>

<P>The <I>escaped</I> Non-<A HREF="#bootstrapdef">BootStrap</A> key-command, including any necessary pauses, and the (highly-recommended) call to <CODE>'zTSlp'</CODE>. For example:
<BR> &nbsp; &nbsp; <CODE>\\\\\\{#insert zCpWW\\\\\\}\\\\\\{#sleep 10\\\\\\}</CODE>
<BR>(note that <CODE>'zCpWW'</CODE> already has a call to <CODE>'zTSlp'</CODE>).</P>

<P>This key-command must be unique among all TPKC commmands, bootstrap or not. If a command has a bootstrap-key-command, then that key-command must <I>not</I> be configured in any <CODE>'NbsKcEsc1'</CODE> variable. Conflicting key-commands may be diagnosed via the TPKC debugging commands.............</P>

<P>This configuration-variable only exists (is only recognized) when the corresponding <CODE>'NbsKcCount'</CODE> variable is greater than zero. There must be one of these phrases for each number in the count, starting with one. For example, if
<BR> &nbsp; &nbsp; <CODE>zTpkcFileCloseNbsKcCount</CODE>
<BR>is
<BR> &nbsp; &nbsp; <CODE>3</CODE>
<BR>then these three phrases must exist:<UL>
	<LI><CODE>zTpkcFileCloseNbsKcEsc1</CODE></LI>
	<LI><CODE>zTpkcFileCloseNbsKcEsc2</CODE></LI>
	<LI><CODE>zTpkcFileCloseNbsKcEsc3</CODE></LI>
</UL></P>

<H4><U>Why is this value escaped?</U></H4>

<P>So it's value can be used to both <I>show you the key-command</I>, for the purposes of diagnosing conflicts (conflicts must be manually dealt with by you--there is no programmatic way set up to do this), as well as actually assigning the key-command to the command itself.</P>

<a name="zTpkcFileCloseNbsKcCount"/>
<H4>User-specific TPKC-config-var: <U><CODE>zTpkc<I>[full-command-name]</I>NbsKcCount</CODE></U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFileCloseNbsKcCount</CODE></LI>
</UL></P>

<P>The number of Non-<A HREF="#bootstrapdef">BootStrap</A> key-commands, each of which is configured in a corresponding <CODE>'NbsKcEsc1'</CODE> phrase. This must be an integer, one or greater. It is recommended to be no more than five.</P>

<a name="zTpkcFileCloseAbrv1C"/>
<H4>Global TPKC-config-var: <U><CODE>zTpkc<I>[full-command-name]</I>Abrv1C</CODE></U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFileCloseAbrv1C</CODE></LI>
</UL></P>

<P>The very-short (recommended to be no more than 4-6 characters) abbreviation for this command. This abbreviation is used in two ways:<OL>
	<LI>To uniquely identify the <I>names</I> of the <B><I><U>global</U></I></B> phrases/configuration-variables of one TPKC-command-instance from another.</LI>
	<LI>To identify which specific command a particular action should be taken on. This is input directly by the user. This is discussed in...............</LI>
</OL></P>

<a name="zTpkcFclsNameTC"/>
<H4>Global TPKC-config-var: <U><CODE>zTpkc<I>[command-abbreviation]</I>NameTC</CODE></U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFclsNameTC</CODE></LI>
</UL></P>

<P>The full name of the command, exactly as it exists in the TextPad Preferences dialog, under the &quot;Keyboard&quot; branch:
	<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences... &gt; Keyboard &gt; <I>[category]</I></CODE></P>

<P><CODE>'TC'</CODE> stands for &quot;Title Case&quot;. There may be no spaces in the name.</P>

<P>This is used to uniquely identify the <I>names</I> of the <B><I><U>user-specific</U></I></B> phrases/configuration-variables of one TPKC-command-instance from another.</P>

<H4><U>Exception: Characters category</U></H4>

<P>There are no names in the &quot;Characters&quot; category. Each has been assigned a description name, as appropriate. For example, a lowercase a with a tilde-accent over it (<CODE>'~'</CODE>) has been assigned the full-name
<BR> &nbsp; &nbsp; <CODE>CharALowerTilde</CODE></P>

<a name="zTpkcFclsGTStepsFromListTop"/>
<H4>Global TPKC-config-var: <U><CODE>zTpkc<I>[command-abbreviation]</I>GTStepsFromListTop</CODE></U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFclsGTStepsFromListTop</CODE></LI>
</UL></P>

<P>The specific navigational steps needed to get to this particular command from within the &quot;Commands&quot; list
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences... &gt; Keyboard &gt; Commands</CODE>
<BR>when the top-most command is selected.</P>

<P>For example, in the below screenshot, the top most command in the <CODE>'Search'</CODE> category is currently selected. The steps necessary to get to the <CODE>'IncrementalFind'</CODE> command are
<BR> &nbsp; &nbsp; <CODE>\\\{#insert zPGDN\\\}\\\{#insert zUP\\\}</CODE>
<BR>The steps needed to get to the <CODE>'BookmarkClearAll'</CODE> command are <I>nothing</I>.</P>

<IMG SRC="preferences_dialog_search_category.jpg">

<a name="zTpkcFclsCatName"/>
<H4><U>zTpkc<I>[command-abbreviation]</I>CatName</U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFclsCatName</CODE></LI>
</UL></P>

<P>The name of the category in which this command is a member. Must equal one of the following (without the square-brackets), as defined by <CODE>'zTpkcAllCategoriesAbrv1CQbl'</CODE>
<BR> &nbsp; &nbsp; <CODE>\\\{#insert zTpkcAllCategoriesAbrv1CQbl\\\}</CODE></P>

<a name="zTpkcFclsBootstrapPhrsNmIf"/>
<H4><U>zTpkc<I>[command-abbreviation]</I>BootstrapPhrsNmIf</U> &nbsp; &nbsp; <CODE>[<A HREF="#cfgvars">back</A>]</CODE></H4>

<P><UL>
	<LI><B>Example phrase-name:</B> <CODE>zTpkcFclsBootstrapPhrsNmIf</CODE></LI>
</UL></P>

<P>If this command is a <A HREF="#bootstrapdef">bootstrap</A> (meaning it has a boostrap key-command), then this is the <I>name</I> of that bootstrap command (phrase). For example, <CODE>'FileClose'</CODE> is indeed a bootstrap--specifically, it is an XBN-PhraseExpress bootstrap. It's bootstrap key-command (bootstrap-kc) is defined in
<BR> &nbsp; &nbsp; <CODE>XBN-PhraseExpress/TextPad/dialogs/preferences/tp_preferences_dialog_bootstrap_commands.px</CODE>
<BR>and is named
<BR> &nbsp; &nbsp; <CODE>zTEFileClose</CODE></P>

<P>Therefore, the value of this phrase is the string
<BR> &nbsp; &nbsp; <CODE>zTEFileClose</CODE>.</P>

<PRE>

<HR>

</PRE>
<a name="zTpkcCreateAllGlblCmdCfgFilesForAllCats"/>
<H2>Process: <CODE>zTpkcCreateAllGlblCmdCfgFilesForAllCats</CODE></H2>

<P>Before the global command-configuration can be generated, the raw global-command configuration must exist. The <I>input</I> for this process IS the &quot;raw&quot; global-command config. See <A HREF="#bldglblcfg">Building the tpkc global command-configuration from scratch</A>.</P>

This process tranforms &quot;raw&quot; global-command configuration lines, such as
<PRE STYLE="background-color:#E1E1E1;"><B>[non-ag-dir]\selection.txt:</B>
SelectAll   zTPSelectAll   Slall   {#insert zzEmptyStringMarker}   {#insert zzEmptyStringMarker}   (*NOTHING. Top command in list*)
SelectBeginBlock   Slbblk   {#insert zzEmptyStringMarker}   \\\{#insert zzpDown5slp\\\}</PRE>

<P>into inidividual tpkc-global config files (each line is an importable phrase):</P>

<PRE STYLE="background-color:#E1E1E1;"><B>[ag-dir]\selection\SelectAll.px.txt:</B>
zTpkcSelectAllAbrv1C   Slall zTpkcSelectAllAbrv1C
zTpkcSlallNameTC   SelectAll   zTpkcSlallNameTC
zTpkcSlallPhrsNm   zTPSelectAll   zTpkcSlallPhrsNm
zTpkcSlallIsBtstrp_yes      zTpkcSlallIsBtstrp_yes
zTpkcSlallType_mcrTl      zTpkcSlallType_mcrTl
zTpkcSlallStpsFrmLstTop   (*NOTHING. Top command in list*)   zTpkcStpsFrmLstTop</PRE>

<P>and</P>
<PRE STYLE="background-color:#E1E1E1;"><B>[ag-dir]\selection\SelectBeginBlock.px.txt:</B>
zTpkcSelectBeginBlockAbrv1C   Slbblk   zTpkcSelectBeginBlockAbrv1C
zTpkcSlbblkNameTC   SelectBeginBlock   zTpkcSlbblkNameTC
zTpkcSlbblkPhrsNm   zTPSelBeginBlock   zTpkcSlbblkPhrsNm
zTpkcSlbblkIsBtstrp_yes   {#insert zzEmptyStringMarker}   zTpkcSlbblkIsBtstrp_yes
zTpkcSlbblkType_mcrTl      zTpkcSlbblkType_mcrTl
zTpkcSlbblkStpsFrmLstTop   \\\{#DOWN\\\}\\\{#insert z5ThnTSlp\\\}   zTpkcStpsFrmLstTop</PRE>

<P>Here are the <A HREF="#bldglblcfgdirs">specific input and output directories</A> for TPKC global command-configuration.</P>

<H3>zTpkcCreateAllGlblCmdCfgFilesForAllCats: Input line format</H3>

For example:

<P><CODE>DocumentEnd   zGTDocBottom   Crdce   {#insert zzEmptyStringMarker}   {#insert zzEmptyStringMarker}   \\\{#PGDN\\\}\\\{#insert z5ThnTSlp\\\}\\\{#UP\\\}\\\{#insert z5ThnTSlp\\\}</CODE></P>

Each line contains a single built-in TextPad command. There are four items, each delimited by a tab.

<H3>ITEM ONE: Full command name</H3>

<P>Exactly as in
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences &gt; Keyboard &gt; [category-name] &gt; Commands</CODE>
<BR>(Note that the 'Characters' category is the only exception. There are special command names assigned to each character-command-item.)</P>

<H3>ITEM TWO: The default phrase-name</H3>

<P>The name of the phrase that triggers this command, via its main key-command. The "main" key-command is:<UL>
	<LI><B>If this is a <A HREF="#bootstrapdef">bootstrap</A> command:</B> The bootstrap key-command</LI>
	<LI><B>If not a bootstrap:</B> The FIRST key-command in the raw user-config files. This is the UNESCAPED key-command as defined in <CODE>zTpkc[cmd-name]NbsKcEsc1</CODE> (for example: <CODE>zTpkcDocumentEndNbsKcEsc1</CODE>).</LI>
</UL></P>

<P>This phrase is automatically created by the TPKC process. Only a <I>single</I> phrase is created (hence only one default phrase-name!), and only <I>one</I> key-command is used. Creating alternative phrases that use the other configured key-commands--such as <CODE>zTpkcDocumentEndNbsKcEsc2</CODE> must be done external to this TPKC project.</P>

<H3>ITEM THREE: Command abbreviation</H3>

<P>A short, 1-case (only the first character is uppercase) abbreviation for the command name. Must be unique among ALL TextPad commands, in all categories. May only contain letters and digits, and is recemmonded to be four-to-five characters in length.</P>

<H3>ITEM FOUR: Command type</H3>

<P>What is the type of this command? This is equal to one of the following: "macro", "tool", or "{#insert zzEmptyStringMarker}".</P>

<H4><U><CODE>'macro'</CODE></U></H4>

<P>If this is a user-created Macro (or one of the example macros existing when TextPad is first installed), then its command-type is "macro". All macros can be edited and deleted by the user.</P>

<H4><U><CODE>'tools'</CODE></U></H4>

<P>If this is a user-created Tool (or one of the example Tools existing when TextPad is first installed), then its command-type is "tool". All tools can be edited and deleted by the user.</P>

<H4><U><CODE>'{#insert zzEmptyStringMarker}'</CODE></U></H4>

<P>All non-user-created commands are &quot;built in&quot;. They cannot be edited or deleted. The only thing the user can do is edit its key-commands. In the raw-configuration, this value is <CODE>'{#insert zzEmptyStringMarker}'</CODE>. Ultimately, however, this value is the empty-string (<CODE>''</CODE>). See the top of this section for an example.</P>

<H3>ITEM FIVE: Is this command a bootstrap</H3>

<P>If this command is a <A HREF="#bootstrapdef">bootstrap</A> in any of the following files<UL>
	<LI>{#insert zXPROOT_DIR_textpad}bootstrap_commands.px.txt</LI>
	<LI>{#insert zXPROOT_DIR_tpkc}bootstrap_commands.px.txt</LI>
	<LI>{#insert zXPROOT_DIR_global}bootstrap_commands.px.txt</LI>
	<LI>{#insert zXPROOT_DIR_phraseExpress}bootstrap_commands.px.txt</LI>
</UL>
<BR>Then this value must be <CODE>'yes'</CODE>. Otherwise, this value must equal <CODE>'zzEmptyStringMarker'</CODE> ('{#insert zzEmptyStringMarker}')</P>

<P>(If it DOES have a bootstrap, then it will only be in one of these files.)</P>

<H3>ITEM FOUR: Steps from Command-list top, to this specific command</H3>

<P>In
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Configure &gt; Preferences &gt; Keyboard &gt; [category-name] &gt; Commands</CODE>
<BR>when the top-most command is selected, this is the sequence of steps necessary to get to <I>this</I> command. If this command IS the top-most, then this value should be a comment stating that.</P>

<I>Each step should be a raw PhraseExpress function call, as described in the section &quot;<A HREF="#bldglblcfg">Building the tpkc global command-configuration from scratch</A>&quot;</I>

<H3>Note</H3>

<P>Note that the command's category is implied by the file in which it exists. For example: <CODE>characters.txt</CODE></P>








<PRE>

<HR>

</PRE>
<a name="zConvertTextPadKCCatListingsToPEConfig"/>
<H2>Process: <CODE>zConvertTextPadKCCatListingsToPEConfig</CODE></H2>

<P>This process reads the &quot;raw&quot; user-specific command configuration, and converts it into the phrase-configuration needed by the TPKC project. Specifically, this takes the list of <I>every</I> built-in TextPad command, as generated by
<BR> &nbsp; &nbsp; <CODE>Preferences &gt; Keyboard &gt; Category:All &gt; [List-button]</CODE>, and transforms it into one file for each category (such as <CODE>file.px.txt</CODE> and <CODE>characters.px.txt</CODE>).</P>

<H1>All of the following has valid concepts, but assumes that the &quot;all&quot; category is NOT generated. But the process has since been updated to <I>specifically</I> begin with this All category, and no others. This process actually splits this all-file into the below files (via bookmarking and then creating new files using only those lines). It then proceeds as documented here. SO: All the user has to do is generate and save the all-category, and not touch it in the least. They do, however, have to still conform to the restrictions below, EXCEPT where it says that lines have to be deleted--NO lines should be deleted (they are automatically ignored, as long as the naming restrictions are followed).</H1>

<P>Every category listing is required to exist in its own file (except the 'All' category, which is ignored by this process). All files are expected to exist in
<BR> &nbsp; &nbsp; <CODE>zzTpkcDirCatListingsOriginal</CODE>
<BR> &nbsp; &nbsp; <CODE>{#insert zzTpkcDirCatListingsOriginal}</CODE>
<BR>and be named the following:<UL>
	<LI>characters.txt</LI>
	<LI>clip_library.txt</LI>
	<LI>configure.txt</LI>
	<LI>cursor.txt</LI>
	<LI>edit.txt</LI>
	<LI>help.txt</LI>
	<LI>macros.txt</LI>
	<LI>search.txt</LI>
	<LI>selection.txt</LI>
	<LI>tools.txt</LI>
	<LI>view.txt</LI>
	<LI>window.txt</LI>
</UL></P>

<H3>Special notes for EVERY category</H3>

<P><UL>
	<LI>ONLY command-names and their key-commands (where each kc being separated by multiple spaces) may exist in these files. Eliminate all empty lines and headers ('COMMANDS:   KEYS:').</LI>
	<LI>No bootstrap key-commands may exist in these files. Eliminate ALL the following key-commands (ignoring 'sleep' and calls to 'zTSlp') from the above files. Do not eliminate the entire line, only that single key-command (and its immediately-preceding tab):
	<BR> &nbsp; &nbsp; <CODE>{#insert zzAllBootstrapCmdListWEscdKC}</CODE></LI>
</UL></P>

<H3>Special notes for 'Tools' category</H3>

<P>Only BUILT-IN commands are recognized. Therefore, only the following nine commands must exist in the file:<UL>
	<LI>ToolCompareFiles</LI>
	<LI>ToolExplorer</LI>
	<LI>ToolHTMLValidate</LI>
	<LI>ToolRerun</LI>
	<LI>ToolRun</LI>
	<LI>ToolSort</LI>
	<LI>ToolSpell</LI>
	<LI>ToolStop</LI>
	<LI>ToolWildEdit</LI>
</UL><BR>Delete all other commands.</P>

<P>Also note that ALL commands in the 'Tools' category--both in the tools.txt file AND in
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Preferences &gt; Keyboard &gt; Categories &gt; Tools</CODE>
must start with a letter LOWER than 't'. In other words, commands starting with U, V, W, X, Y, or Z MUST not exist. This is critical to the TPKC project to actually working!</P>

<H3>Special notes for 'Macros' category</H3>

<P>Similar to 'tools.txt', 'macros.txt' may only contain the following five commands:<UL>
	<LI>MacroMultiplay</LI>
	<LI>MacroPause</LI>
	<LI>MacroPlay</LI>
	<LI>MacroRecord</LI>
	<LI>MacroSave</LI>
</UL></P>


<P>Also note that ALL commands in the 'Macros' category--both in the macros.txt file AND in
<BR> &nbsp; &nbsp; <CODE>TextPad &gt; Preferences &gt; Keyboard &gt; Categories &gt; Macros</CODE>
must start with a letter OTHER than 'm'. This is critical to the TPKC project to actually working!</P>

<P>Beyond these requirements, all these files should be left exactly as output by TextPad 7.0.7.</P>




<PRE>

<HR>

</PRE>
<a name="zTranslateFullyFinnessedCatListingsToPeCfg_M_catl"/>
<H2>Process: <CODE>zTranslateFullyFinnessedCatListingsToPeCfg_M_catl</CODE></H2>


<PRE STYLE="background-color:#E1E1E1;">The phrases in this document translate the TextPad built-in-command category listings (after all replacements are made via ............)

	Char01UpsideDownExclaimation   1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}
	Char02UpsideDownQuestion   2   \\\\\\{#insert zCpCOMMA\\\\\\}   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}
	Char03QuestionUnknown1of3   1   \\\\\\{#insert zCpSEVEN\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zSpOO\\\\\\}

To the user-configuration phrase as required by the Tpkc project:

	zzTpkcChar01UpsideDownExclaimationNbsKcEsc1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}   zzTpkcChar01UpsideDownExclaimationNbsKcEsc1
	zzTpkcChar01UpsideDownExclaimationNbsKcCount   1   zzTpkcChar01UpsideDownExclaimationNbsKcCount
	zzTpkcChar02UpsideDownQuestionNbsKcEsc1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}   zzTpkcChar02UpsideDownQuestionNbsKcEsc1
	zzTpkcChar02UpsideDownQuestionNbsKcEsc2   \\\\\\{#insert zCpCOMMA\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}   zzTpkcChar02UpsideDownQuestionNbsKcEsc2
	zzTpkcChar02UpsideDownQuestionNbsKcCount   2   zzTpkcChar02UpsideDownQuestionNbsKcCount
	zzTpkcChar03QuestionUnknown1of3NbsKcEsc1   \\\\\\{#insert zCpSEVEN\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zSpOO\\\\\\}   zzTpkcChar03QuestionUnknown1of3NbsKcEsc1
	zzTpkcChar03QuestionUnknown1of3NbsKcCount   1   zzTpkcChar03QuestionUnknown1of3NbsKcCount

Step one in this process is to change all tabs THAT ARE IMMEDIATELY PREVIOUS TO A KEY-COMMAND, to be a new-line:

	Char01UpsideDownExclaimation   1
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}
	Char02UpsideDownQuestion   2
	\\\\\\{#insert zCpCOMMA\\\\\\}
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}
	Char03QuestionUnknown1of3   1
	\\\\\\{#insert zCpSEVEN\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zSpOO\\\\\\}

This is done via a loop.
	Iteration one replaces all lines with ONE key-command
		([A-Za-z0-9]+\t[0-9]+)\t([^\t\n\r]+)$
		$1\n$2
	Such as
		Char01UpsideDownExclaimation   1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}
	to
		Char01UpsideDownExclaimation   1
		\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}

	Iteration two does the same thing for lines with TWO key-commands:
		([A-Za-z0-9]+\t[0-9]+)\t([^\t\n\r]+)\t([^\t\n\r]+)$
		$1\n$2\n$3
	Such as
		Char02UpsideDownQuestion   2   \\\\\\{#insert zCpCOMMA\\\\\\}   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}
	to
		Char02UpsideDownQuestion   2
		\\\\\\{#insert zCpCOMMA\\\\\\}
		\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}

	Iteration three is for THREE kcs, and so on. The number of iterations is determined by
		zTpcpMaximumNumberOfKCsPerCmd
	Note that the number after the first tab is ignored by these replacements. They SHOULD be accurate, but that is not a requirement of these REGEX-es.


zvFND_WHAT_PRE_DLR
	Contains the find-what regex, EXCEPT the ending dollar-sign. Here's the full regex needed for when the kc-count is one:
		([A-Za-z0-9]+\t[0-9]+)\t([^\t\n\r]+)$
	 zvFND_WHAT_PRE_DLR is initialized to
		 ([A-Za-z0-9]+\t[0-9]+)
	 and each iteration of the loop, before actually executing the replacement, appends a new
		 \t([^\t\n\r]+)
	 to it. So, for iteration one, zvFND_WHAT_PRE_DLR is
		([A-Za-z0-9]+\t[0-9]+)\t([^\t\n\r]+)
	For iteration two:
		([A-Za-z0-9]+\t[0-9]+)\t([^\t\n\r]+)\t([^\t\n\r]+)
	And so on. The ultimate value of the find-what field is
		\\\{#insert zvFND_WHAT_PRE_DLR\\\}$

 zvRPLC_WITH
	 Contains the replace-with-this REGEX. For example, here is the full REGEX in the replace-with field, for when the kc-count is one:
		 $1\n$2
	 zvRPLC_WITH is initialized to
		 $1
	 and, in each loop iteration, the following is appended, before the replacement is made:
		 \n[the current loop-number+1]
	 In iteration one, zvRPLC_WITH ends up equalling
		 $1\n$2
	 In iteration two:
		 $1\n$2\n$3
	 and so on.

To repeat the above, here's the result of all these replacements in this first step:

	Char01UpsideDownExclaimation   1
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}
	Char02UpsideDownQuestion   2
	\\\\\\{#insert zCpCOMMA\\\\\\}
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}
	Char03QuestionUnknown1of3   1
	\\\\\\{#insert zCpSEVEN\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zSpOO\\\\\\}

The next step is to transform it to its final form:

	zzTpkcChar01UpsideDownExclaimationNbsKcEsc1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}   zzTpkcChar01UpsideDownExclaimationNbsKcEsc1
	zzTpkcChar01UpsideDownExclaimationNbsKcCount   1   zzTpkcChar01UpsideDownExclaimationNbsKcCount
	zzTpkcChar02UpsideDownQuestionNbsKcEsc1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}   zzTpkcChar02UpsideDownQuestionNbsKcEsc1
	zzTpkcChar02UpsideDownQuestionNbsKcEsc2   \\\\\\{#insert zCpCOMMA\\\\\\}\\\\\\{#insert zUPR_SLASH\\\\\\}   zzTpkcChar02UpsideDownQuestionNbsKcEsc2
	zzTpkcChar02UpsideDownQuestionNbsKcCount   2   zzTpkcChar02UpsideDownQuestionNbsKcCount
	zzTpkcChar03QuestionUnknown1of3NbsKcEsc1   \\\\\\{#insert zCpSEVEN\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zSpOO\\\\\\}   zzTpkcChar03QuestionUnknown1of3NbsKcEsc1
	zzTpkcChar03QuestionUnknown1of3NbsKcCount   1   zzTpkcChar03QuestionUnknown1of3NbsKcCount

Here is the first item (command) to process:
	Char01UpsideDownExclaimation   1
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}

First, cut the name and then the kc-count, and store them in
	zvCMD_NM_TC
and
	zvNBS_KC_CNT

The remaining text:
	[[CURSOR]]
	\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}

In this now-empty line, write the NbsKcCount variable
	zzTpkcChar01UpsideDownExclaimationNbsKcCount   1   zzTpkcChar01UpsideDownExclaimationNbsKcCount
and move to the beginning of the next line:
	zzTpkcChar01UpsideDownExclaimationNbsKcCount   1   zzTpkcChar01UpsideDownExclaimationNbsKcCount
	[[CURSOR]]\\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}

Finally, do a loop for each key-command, as determined by the number in zvNBS_KC_CNT. Translate each line to the proper 'NbsKcEsc#' line. The final result:
	zzTpkcChar01UpsideDownExclaimationNbsKcCount   1   zzTpkcChar01UpsideDownExclaimationNbsKcCount
	zzTpkcChar01UpsideDownExclaimationNbsKcEsc1   \\\\\\{#insert zCpUPR_SLASH\\\\\\}\\\\\\{#sleep 25\\\\\\}\\\\\\{#insert zONE\\\\\\}   zzTpkcChar01UpsideDownExclaimationNbsKcEsc1
</PRE>


<PRE>

<HR>

</PRE>
<a name="zTranslateFullyFinnessedCatListingsToPeCfg_M_catl"/>
<H2>Process: <CODE>zTranslateFullyFinnessedCatListingsToPeCfg_M_catl</CODE></H2>

About to split the 'All' category's command-list, as generated via
	TextPad &gt; Configure &gt; Preferences &gt; Keyboard &gt; All &gt; [List-button]
into the individual category raw-config needed by the XBN-PhraseExpress TPKC project. The CURRENTLY-OPEN file (where you called zTpkcSplitAllListToIndvCatFiles) must be the original 'All' category-list.

The first steps I will take are to duplicate the text from this original document, duplicate it to a new-and-temporary document, and then close this original file.

--INPUT AND OUTPUT DIRECTORIES--

This process can be run for either THIS computer, or for other computers. 'Other' computers meaning someone has sent you their 'All'-category command-list, and you want to process it for them and send them back the final output user-config phrase-files.

When running for THIS computer, the input directory is:
	-zXPROOT_DIR_tpkcRawCfgUserThisCmptr:
	{#insert zXPROOT_DIR_tpkcRawCfgUserThisCmptr}
and the output directory is
	-zzXPSUB_DIR_tpkcUsrCfg10thr13OutBase_M_tpkcum:
	{#insert zzXPSUB_DIR_tpkcUsrCfg10thr13OutBase_M_tpkcum}

When running for OTHER computers, the base-directory for BOTH input and output is
	{#insert zXPROOT_DIR_tpkcCatLstCrVrOtherComputers}
There is a sub-directory for every user, such as 'smith', and within each, is an 'input' and 'output' directory. So the input directory for Smith is
	zXPROOT_DIR_tpkcRawCfgUserOtherCmptrsInput_M_tpkcum (where zvUSER_NAME_DIR is 'smith'):
	{#SETPHRASE -description zvUSER_NAME_DIR -content smith -autotext zvUSER_NAME_DIR -folder ctvv_folder}{#insert zXPROOT_DIR_tpkcRawCfgUserOtherCmptrsInput_M_tpkcum}
and output directory is
	zXPROOT_DIR_tpkcRawCfgUserOtherCmptrsOutput_M_tpkcum (where zvUSER_NAME_DIR is 'smith'):
	{#SETPHRASE -description zvUSER_NAME_DIR -content smith -autotext zvUSER_NAME_DIR -folder ctvv_folder}{#insert zXPROOT_DIR_tpkcRawCfgUserOtherCmptrsOutput_M_tpkcum}
	{#insert zXPROOT_DIR_tpkcCatLstCrVrOtherComputers}smith\output\

These other-computer directories are intended to be temporary, but are distinguished in this way (per-user), in case you are processing the config files for more than one person. When processing is complete, you'll zip up the 'smith' directory, send it to them, and then delete the directory entirely (and perhaps archive and backup that zip in case they need it again).

The input-directory must contain this file: {#insert zzTpkcAllCatListFileName}

This is the file containing the ORIGINAL command list, as generated by
	TextPad &gt; Configure &gt; Preferences &gt; Keyboard &gt; All &gt; [List-button]

--NAMING RESTRICTIONS FOR YOUR CUSTOM COMMANDS (tools and macros categories)--

The names of your user-created macros and tools may NOT match any of the following regexes.

Category characters:
	^[^A-Za-z0-9 _]__SPACE__   (A single, non-alpha-numeric character at the beginning, followed by a space)
Category clip:
	^Clip
Category 'configure':
	^Block
	^Customize
	^Preferences
	^RightMargin
	^Toggle
Category 'cursor':
	^Char
	^Document
	^GoTo
	^Line
	^Page
	^Para
	^Tab
	^View(Start|End)
	^Word
Category 'edit':
	^Edit
	^EmptyClipboard
Category 'file':
	^File
	^Workspace
Category 'help':
	^Help
Category 'macro':
	^Macro
Category 'search':
	^Bookmark
	^Incremental
	^Match
	^Regex
	^Search
Category 'select':
	^Select
Category 'tools':
	^Tool[^0-9]
Category 'view':
	^View
	^Activate
	^StayOnTop
Category 'window':
	^Window


[[[This list of regexes must be manually maintained. They come from the phrases zzMarkAllCmdsInCatMoveToNewFile_[category-name] in the file _tpkc_all_cat_list_to_indv_cat_lists.px.txt.]]]

In addition, your macros MUST not start with an 'M', and your tools MUST not start with ANY of these letters: 'T', 'U', 'V', 'W', 'X', 'Y', 'Z' (in other-words, 'T' and anything that comes AFTER it). Although THIS build process (zTpkcSplitAllListToIndvCatFiles) will not fail--and will not detect this problem--actually assigning your key-commands for the BUILT-IN commands will fail.

<PRE>




























</PRE>
</BODY></HTML>



