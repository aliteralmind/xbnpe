<HTML><HEAD>
	<TITLE></TITLE>
	<meta name="viewport" content="width=device-width" />
</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF"><a name="top"></a>

<P>[<A HREF="../index.html">BACK</A>]<CODE> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </CODE><I>(XBN-PhraseExpress is released under the <A HREF="../index.html#lpgl">LPGL 2.1</A>)</I>

<HR/>

<H1>PhraseExpress: Documentation and notes on specific built-in Pex functionality</H1>

<P><B>Contents:</B><UL>
	<LI><CODE>[<A HREF="#keypresscount">go</A>]</CODE> &nbsp; No variables or phrase calls in key-press <CODE>'-count'</CODE> field.</LI>
	<LI><CODE>[<A HREF="#balloon">go</A>]</CODE> &nbsp; <CODE>BALLOON</CODE></LI>
	<LI><CODE>[<A HREF="cond_tag.html">go</A>]</CODE> &nbsp; <CODE>COND</CODE> <I>(in-depth)</I></LI>
	<LI><CODE>[<A HREF="#insertfile">go</A>]</CODE> &nbsp; <CODE>INSERTFILE</CODE></LI>
	<LI><CODE>[<A HREF="#msgbox">go</A>]</CODE> &nbsp; <CODE>MSGBOX</CODE></LI>
	<LI><CODE>[<A HREF="#targetcomparison">go</A>]</CODE> &nbsp; Targets: <CODE>MSGBOX</CODE>, <CODE>COND</CODE>, <CODE>loop</CODE></LI>
</UL></P>

<P><I>For PhraseExpress language-issues not specific to any one function, see <CODE><A HREF="pex_troubleshooting.html">pex_troubleshooting.html</A></CODE>.</I></P>


<PRE>

<HR/>

</PRE>
<a name="targetcomparison"/><H2>[<A HREF="#top">top</A>] &nbsp; Targets: <CODE>MSGBOX</CODE>, <CODE>COND</CODE>, <CODE>LOOP</CODE></H2>

<P>Some functions require their targets (the phrases to call under certain conditions) be either phrase calls:
<BR> &nbsp; &nbsp; <CODE>{#insert zPhraseToCall}</CODE>
<BR>or only phrase names:
<BR> &nbsp; &nbsp; <CODE>zPhraseToCall</CODE></P>

<P><TABLE ALIGN="center" BORDER="1" CELLSPACING="0" CELLPADDING="4" BGCOLOR="#EEEEEE"><TR ALIGN="center" VALIGN="middle">
	<TD><B><U>Function</U></B></TD>
	<TD><B><U>Target parameters</U></B></TD>
	<TD><B><U>Target is phrase-name or phrase-call?</U></B></TD>
</TR><TR ALIGN="center">
	<TD ALIGN="right"><B><U><A HREF="#msgbox">MSGBOX</A></U></B></TD>
	<TD><CODE>'-ok'</CODE>, <CODE>'-yes'</CODE>, <CODE>'-no'</CODE>, <CODE>'-cancel'</CODE></TD>
	<TD>Phrase name only</TD>
</TR><TR ALIGN="center">
	<TD ALIGN="right"><B><U><A HREF="cond_tag.html">COND</A></U></B></TD>
	<TD><CODE>'-then'</CODE>, <CODE>'-else'</CODE></TD>
	<TD>Phrase name only</TD>
</TR><TR ALIGN="center">
	<TD ALIGN="right"><B><U>LOOP</U></B></TD>
	<TD>The &quot;action&quot;, immediately following &quot;<CODE>{#LOOP </CODE>&quot;</TD>
	<TD>Phrase-call</TD>
</TR></TABLE></P>


<PRE>

<HR/>

</PRE>
<a name="msgbox"/><H2>[<A HREF="#top">top</A>] &nbsp; Built-in PhraseExpress function: <CODE>MSGBOX</CODE></H2>

<P><UL>
	<LI>The <A HREF="#targetcomparison">target</A> of a <CODE>MSGBOX</CODE> (in the <CODE>'-ok'</CODE>, <CODE>'-yes'</CODE>, <CODE>'-no'</CODE>, and/or <CODE>'-cancel'</CODE> parameters) must be the phrase-name only.</LI>
	<LI>Note that, along with <A HREF="#balloon"><CODE>BALLOON</CODE>-s</A>, comments in the text of a <CODE>MSGBOX</CODE> are <A HREF="pex_enhancement_requests.html#wishcmtmbx">literally displayed</A>.</LI>
</UL></P>

<H4>Problem: <CODE>' -defaultok'</CODE> immediately following <CODE>'-cancel'</CODE></H4>

<CODE>' -defaultok'</CODE> at the end of a <CODE>MSGBOX</CODE> <I>that has a cancel option right before it</I>, causes the cancel option's <I>target</I> to be ignored (never called), although the button is still displayed.

<PRE STYLE="background-color:#E1E1E1;">{#MSGBOX -head default ok test -text default ok test -ok zQokQ -cancel zQcancelQ -defaultok}
zQokQ
ok
zQcancelQ
cancel</PRE>

<a name="balloon"/><H2>[<A HREF="#top">top</A>] &nbsp; Built-in PhraseExpress function: <CODE>BALLOON</CODE></H2>

<P>Note that, along with <A HREF="#msgbox"><CODE>MSGBOX</CODE>-s</A>, comments in the text of a <CODE>BALLOON</CODE> are <A HREF="pex_enhancement_requests.html#wishcmtmbx">literally displayed</A>.</P>

<P>There is no way to print <I>nothing</I> when clicking on <CODE>BALLOON</CODE>. The <CODE>'-text'</CODE> value always print out, unless there is also text in the <CODE>'-onclick'</CODE> parameter, in which case that prints out in its place.</P>

<P>There is also no way to <I>dismiss</I> the balloon when clicking on it.</P>

<P><I>(7/20/2013: <A HREF="http://www.phraseexpress.com/phpBB3/viewtopic.php?f=138&t=11534">http://www.phraseexpress.com/phpBB3/viewtopic.php?f=138&t=11534</A>)</I></P>

<PRE>

<HR/>

</PRE>
<a name="keypresscount"/><H2>[<A HREF="#top">top</A>] &nbsp; No variables or phrase calls in key-press <CODE>'-count'</CODE> field.</H2>


<PRE STYLE="background-color:#E1E1E1;">{#UP -count {#insert zvNUMBER}}</PRE>

<P>is not allowed. The <CODE>'-count'</CODE> field must be a static number, such as
<BR> &nbsp; &nbsp; <CODE>{#UP -count 3}</CODE></P>

<P>A workaround is to put the key-press into a loop</P>

<PRE STYLE="background-color:#E1E1E1;">{#LOOP {#UP} -count 3}</PRE>

<PRE>

<HR/>

</PRE>
<a name="insertfile"/><H2>[<A HREF="#top">top</A>] &nbsp; <CODE>INSERTFILE</CODE></H2>

<P><I>[Go to <A HREF="#ifldetect">failure-detection tool</A>]</I></P>

<P><B>Problem:</B> If there is a <A HREF="pex_enhancement_requests.html#wishcmtmbx">comment in the path</A> (such as in a variable that defines a portion of that path), <CODE>INSERTFILE</CODE> will not work.</P>

<H3>Long <CODE>INSERTFILE</CODE>-s are unreliable</H3>

<P>When using <CODE>INSERTFILE</CODE> for even moderately-large files, they randomly fail. Specifically, near the bottom of the document, you will get garbled (meaningless) text. There is no solution that I can find, except to not use <CODE>INSERTFILE</CODE>. The alternative I've come up with is to open the desired file
<BR> &nbsp; &nbsp; <CODE>{#insert zDirFileOpen_M_dirFnm}</CODE>
<BR>and copy that text into a new file, closing the original:
<BR> &nbsp; &nbsp; <CODE>{#insert zDupCurrFileTextToNewCloseOrig}</CODE></P>

<P><I>Note:<UL>
	<LI><CODE>'zDirFileOpen_M_dirFnm'</CODE> requires the <A HREF="../xbnpe_phrase_types.html#variable">variables</A> <CODE>'zvDIRECTORY'</CODE> and <CODE>'zvFILE_NAME'</CODE>.</LI>
	<LI><CODE>'zDupCurrFileTextToNewCloseOrig'</CODE> is part of the <B>XBNPE-Char, word, line, para, doc, file (CWLPDF)</B> project.</LI>
</UL></I></P>

<a name="ifldetect"/><H4><CODE>[<A HREF="#insertfile">BACK</A>]</CODE> &nbsp; Tool to detect a failed <CODE>INSERTFILE</CODE></H4>

<P><I><B>Warning:</B> Needs to be further tested!</I></P>

<P>There is a testing tool to verify an INSERTFILE, and crash gracefully when it fails. It only works when there is no whitespace at the start and/or end of the last line (although there may be completely-empty lines after it), and only when you know exactly the text (the first and/or last words) in the last line will be, after the <CODE>INSERTFILE</CODE> is completed.</P>

<P>Before executing the <CODE>INSERTFILE</CODE>, it must be determined what<UL>
	<LI>the first-word-in-the-last-line <U>will</U> be (after the <CODE>INSERTFILE</CODE> is executed), and (or) what</LI>
	<LI>the <I>last</I>-word-in-the-last-line will be.</LI>
</UL>Set these words into the required variables:</P>

<P><CODE STYLE="background-color:#E1E1E1;">{#insert zvEXPECTED_WORD_A_st1stWrdLastLine_M_wwo}{#insert zvEXPECTED_WORD_Z_stLastWrdLastLine}</CODE></P>

<P>Actually insert the file. Call <CODE>INSERTFILE</CODE>.</P>

<P>To validate it, call these functions:</P>
<P><CODE STYLE="background-color:#E1E1E1;">{#insert zAtEOD_cibFirstWrdInLastLine_M_xwrda}{#insert zAtEOD_cibLastWordInDoc_M_xwrdz}</CODE></P>
<PRE>




























</PRE>
</BODY></HTML>



